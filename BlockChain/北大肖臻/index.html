
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>PKU Zhen Xiao - Zzz Finantial</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Zzz Finantial" class="md-header-nav__button md-logo" aria-label="Zzz Finantial">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Zzz Finantial
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              PKU Zhen Xiao
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Zzz Finantial" class="md-nav__button md-logo" aria-label="Zzz Finantial">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Zzz Finantial
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../../BasicConcept/" class="md-nav__link">
        Basic Concept
      </a>
    </li>
  

    
      
      
      


  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
      
      <label class="md-nav__link" for="nav-3">
        Block Chain
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Block Chain" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Block Chain
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          PKU Zhen Xiao
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        PKU Zhen Xiao
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    炒币有风险，投资需谨慎
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-" class="md-nav__link">
    01 - 课程简介
  </a>
  
    <nav class="md-nav" aria-label="01 - 课程简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    参考资料
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    教学大纲：比特币
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-" class="md-nav__link">
    02 - 密码学原理
  </a>
  
    <nav class="md-nav" aria-label="02 - 密码学原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    密码学中哈希函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sha-256" class="md-nav__link">
    比特币中使用的哈希函数：SHA - 256
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    比特币开户
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03-" class="md-nav__link">
    03 - 比特币中的数据结构
  </a>
  
    <nav class="md-nav" aria-label="03 - 比特币中的数据结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hash-pointer" class="md-nav__link">
    哈希指针 Hash Pointer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    区块链
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merkle-tree" class="md-nav__link">
    Merkle Tree
  </a>
  
    <nav class="md-nav" aria-label="Merkle Tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merkle-proof" class="md-nav__link">
    Merkle Proof
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    有环数据结构
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-" class="md-nav__link">
    04 - 比特币协议
  </a>
  
    <nav class="md-nav" aria-label="04 - 比特币协议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    去中心化以及协议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-header" class="md-nav__link">
    Block Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-body" class="md-nav__link">
    Block Body
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#full-node" class="md-nav__link">
    Full Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#light-node" class="md-nav__link">
    Light Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    分布式共识
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consensus-in-bitcoin" class="md-nav__link">
    比特币协议 Consensus in BitCoin
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Quant
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Quant" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Quant
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../QT/" class="md-nav__link">
        Quantative Trading by Ernest P.Chan
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    炒币有风险，投资需谨慎
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-" class="md-nav__link">
    01 - 课程简介
  </a>
  
    <nav class="md-nav" aria-label="01 - 课程简介">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    参考资料
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    教学大纲：比特币
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-" class="md-nav__link">
    02 - 密码学原理
  </a>
  
    <nav class="md-nav" aria-label="02 - 密码学原理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    密码学中哈希函数
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sha-256" class="md-nav__link">
    比特币中使用的哈希函数：SHA - 256
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    比特币开户
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03-" class="md-nav__link">
    03 - 比特币中的数据结构
  </a>
  
    <nav class="md-nav" aria-label="03 - 比特币中的数据结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hash-pointer" class="md-nav__link">
    哈希指针 Hash Pointer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    区块链
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merkle-tree" class="md-nav__link">
    Merkle Tree
  </a>
  
    <nav class="md-nav" aria-label="Merkle Tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merkle-proof" class="md-nav__link">
    Merkle Proof
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    有环数据结构
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-" class="md-nav__link">
    04 - 比特币协议
  </a>
  
    <nav class="md-nav" aria-label="04 - 比特币协议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    去中心化以及协议
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-header" class="md-nav__link">
    Block Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-body" class="md-nav__link">
    Block Body
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#full-node" class="md-nav__link">
    Full Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#light-node" class="md-nav__link">
    Light Node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    分布式共识
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#consensus-in-bitcoin" class="md-nav__link">
    比特币协议 Consensus in BitCoin
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">北京大学 肖臻老师《区块链技术与应用》<a class="headerlink" href="#_1" title="Permanent link">#</a></h1>
<h2 id="_2"><strong>炒币有风险，投资需谨慎</strong><a class="headerlink" href="#_2" title="Permanent link">#</a></h2>
<p>课程视频链接：<a href="https://www.bilibili.com/video/BV1Vt411X7JF?from=search&amp;seid=16020694432638485001">区块链技术与应用</a>，</p>
<p>课程资料链接：<a href="http://zhenxiao.com/blockchain/">课程资料</a></p>
<h2 id="01-"><strong>01 - 课程简介</strong><a class="headerlink" href="#01-" title="Permanent link">#</a></h2>
<p>计算机基础：数组、链表、二叉树、哈希函数</p>
<h3 id="_3"><strong>参考资料</strong><a class="headerlink" href="#_3" title="Permanent link">#</a></h3>
<ol>
<li>Bitcoin and Cryptocurrency Technologies（有点过时）</li>
<li>以太坊白皮书、以太坊黄皮书、源代码</li>
<li>Solidity文档</li>
</ol>
<h3 id="_4"><strong>教学大纲：比特币</strong><a class="headerlink" href="#_4" title="Permanent link">#</a></h3>
<ul>
<li>密码学基础</li>
<li>比特币的数据结构</li>
<li>共识协议和系统实现</li>
<li>挖矿算法和难度调整</li>
<li>比特币脚本</li>
<li>软分叉和硬分叉</li>
<li>匿名和隐私保护</li>
</ul>
<h2 id="02-"><strong>02 - 密码学原理</strong><a class="headerlink" href="#02-" title="Permanent link">#</a></h2>
<p>Crypto-currency 加密货币（但是其实不加密）</p>
<h3 id="_5"><strong>密码学中哈希函数</strong><a class="headerlink" href="#_5" title="Permanent link">#</a></h3>
<p>cryptograhpic hash function，重要性质有</p>
<ul>
<li>(1) collision resistance：如果有两个输入 <span><span class="MathJax_Preview">x\not=y, \ H(x) = H(y)</span><script type="math/tex">x\not=y, \ H(x) = H(y)</script></span>，此时出现 hash collision，一般来说，哈希碰撞是不可避免的。比方说输出空间是 256位，即 <span><span class="MathJax_Preview">2^{256}</span><script type="math/tex">2^{256}</script></span>，但是输入空间是无限大，那么这里根据抽屉原理，一定会有哈希碰撞。所以这里的 collision resistance 意思并不是完全不会有碰撞发生，而是不会有人为的、有效的制造数据的方法，使得能产哈希碰撞。</li>
<li>collision resistance 用法（<strong>Digest</strong>）：有一个消息 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span>，如果有人修改 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 为 <span><span class="MathJax_Preview">m'</span><script type="math/tex">m'</script></span>，那么 <span><span class="MathJax_Preview">H(m) \not= H(m')</span><script type="math/tex">H(m) \not= H(m')</script></span> 就会被检测出来。</li>
<li>collision resistance 无法被证明，只是实验上无法被证伪</li>
<li>例子：<a href="https://en.wikipedia.org/wiki/MD5">MD5</a> 之前被认为是非常安全的哈希函数，但是已经被证明并不是 collision resistance</li>
<li>(2) hiding：<span><span class="MathJax_Preview">x\rightarrow H(x)</span><script type="math/tex">x\rightarrow H(x)</script></span>，已知 <span><span class="MathJax_Preview">H(x)</span><script type="math/tex">H(x)</script></span>，无法知道 <span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>。hiding 成立性质，brute force 情况下输入空间够大、<span><span class="MathJax_Preview">H(x)</span><script type="math/tex">H(x)</script></span> 取值足够均匀（不是集中）</li>
<li>hiding 作用是和 collision resistance 在一起实现 <strong>Digital Commitment</strong>，也称为 <strong>Digital equivalent of a sealed envelope</strong></li>
<li>假设有一个人，他预测股票很准，那么怎么能证明他预测的很准呢？1. 他在电视上公布他的预测结果，查看当天的结果。但是这样会出现他的预测对股市的影响的后果。所以，预测结果不能提前公开。2. 如果不公开预测结果，那么如果知道预测是否被篡改？利用 <strong>sealed envelope</strong>，将预测结果交给第三方机构，然后预测结束之后，再打开。</li>
<li>(3) puzzle friendly：只观测输出，无法知道输入。</li>
<li>例子，观测输出 <span><span class="MathJax_Preview">00...0XX...X</span><script type="math/tex">00...0XX...X</script></span>，那么我们并无法知道哪个输入更有可能得到该输出。</li>
<li>挖矿实际上就是找一个 nonce，使得 <span><span class="MathJax_Preview">H(\text{block header}) \leq target</span><script type="math/tex">H(\text{block header}) \leq target</script></span>，block header 区块链块头，挖矿的过程没有捷径，所以挖到了矿找到了 nonce，实际上就证明你有一定工作量。Difficult to solve, but but easy to verify</li>
</ul>
<h3 id="sha-256"><strong>比特币中使用的哈希函数：SHA - 256</strong><a class="headerlink" href="#sha-256" title="Permanent link">#</a></h3>
<p>SHA，Secure Hash Algorithm，满足以上三个性质的算法</p>
<h3 id="_6"><strong>比特币开户</strong><a class="headerlink" href="#_6" title="Permanent link">#</a></h3>
<ol>
<li>日常生活中开户：带上身份证明去银行办理开户手续。<strong>（中心化）</strong></li>
<li>比特币，则是去中心化。每个用户自己决定开户。用户创立一对 publick key 和 private key （<strong>去中心化</strong>） </li>
</ol>
<p>加密体系算法： Asymmetric Encryption Algorithm</p>
<p>Symmetric Encryption Algorithm</p>
<ol>
<li>如果两个人进行通讯，可能被监听，那么双方使用相同的加密体系，以这种解码方式，来进行通讯。</li>
<li>弱点：密钥的分发不方便</li>
</ol>
<p>非对称：</p>
<ol>
<li>加密和解密都使用接收方的公钥和私钥</li>
<li>信息发送方，只需要使用信息接收方的公钥加密，然后信息接收方使用私钥解密即可</li>
</ol>
<p><strong>签名</strong></p>
<ol>
<li>某 A 发送给某 B，那么就需要有验证，验证即签名。</li>
<li>用 A 的 public key 和 private key 来验证</li>
</ol>
<p><strong>问题</strong>：某人偷取比特币，大量的生成公钥和私钥，然后来偷取比特币。</p>
<p><strong>回答</strong>：概率上非常低。但前提是，需要有一个好的随机源来生成 public key 和 private key。</p>
<h2 id="03-"><strong>03 - 比特币中的数据结构</strong><a class="headerlink" href="#03-" title="Permanent link">#</a></h2>
<h3 id="hash-pointer">哈希指针 Hash Pointer<a class="headerlink" href="#hash-pointer" title="Permanent link">#</a></h3>
<p>hash pointer 保存的数据有：</p>
<ol>
<li>存储结构体在内存中的地址</li>
<li>保存结构体的哈希值</li>
</ol>
<h3 id="_7">区块链<a class="headerlink" href="#_7" title="Permanent link">#</a></h3>
<p><img alt="区块链1" src="../BTC1.png" /></p>
<ol>
<li>区块 + 链表</li>
<li>区块链即：使用哈希指针，代替普通指针。</li>
<li>区块链可以实现 <strong>tamper-evident log</strong>。比如：某人篡改了区块链中的某个内容，则后段哈希指针的内容对不上，就需要改后一个哈希指针，以此类推（链表）。那么只要保存最后一个区块的哈希指针，所有的区块的内容，都能被保存。</li>
</ol>
<h3 id="merkle-tree"><strong>Merkle Tree</strong><a class="headerlink" href="#merkle-tree" title="Permanent link">#</a></h3>
<p><img alt="MerkleTree" src="../MerkleTree.png" /></p>
<p>与 binary tree 的区别为用 hash pointer 来代替普通指针 </p>
<ol>
<li>叶子结点称为 Data Blocks</li>
<li>所有非叶子结点，均只含有 hash pointer</li>
<li>根结点的哈希指针称为 root hash</li>
<li>下方的 TX 为 transaction，交易</li>
</ol>
<p>好处：</p>
<ol>
<li>只要记录根结点的哈希值，那么就可以记录、维护整个树的数据</li>
</ol>
<h4 id="merkle-proof"><strong>Merkle Proof</strong><a class="headerlink" href="#merkle-proof" title="Permanent link">#</a></h4>
<p>Block header（有根哈希值，但没有交易的具体内容） 和 Block body（有交易的内容）</p>
<p>比特币中的节点分为两类：</p>
<ol>
<li>全节点，保存整个区块的内容</li>
<li>轻节点，只保存 block header，（类似手机）</li>
</ol>
<p><strong>Merkle Proof</strong>：验证交易完成方法流程</p>
<ol>
<li>找到当前交易的叶子结点</li>
<li>从当前节点到根节点的路径，就叫为 merkle proof</li>
<li>轻节点，只保存了根哈希值，那么轻节点如何知道当前交易是否包含在当前 merkle tree 内？</li>
<li>轻节点向全节点进行请求：全节点按照 merkle proof 的路径，按顺序计算，每个节点都和轻节点进行比对，然后最后返回根节点的哈希值。如果所有哈希值都正确，那么交易就被包含。</li>
</ol>
<p>Merkle Proof 的证明是 Proof of membership 和 Proof of inclusion，Merkle Proof 的时间复杂度是 <span><span class="MathJax_Preview">O(N)</span><script type="math/tex">O(N)</script></span> 的</p>
<p>如何证明 Proof of non-membership？</p>
<ol>
<li>brute force，整棵树的叶子结点都放进去，这样是 <span><span class="MathJax_Preview">O(N)</span><script type="math/tex">O(N)</script></span> 的</li>
<li>我们如果对叶节点的哈希值排序，那么就可以用二分搜索去证明，就是 <span><span class="MathJax_Preview">O(logN)</span><script type="math/tex">O(logN)</script></span>，代价为排序，Sorted Merkle Tree</li>
</ol>
<h3 id="_8"><strong>有环数据结构</strong><a class="headerlink" href="#_8" title="Permanent link">#</a></h3>
<p>如果是循环链表 + hash pointer，则会出现问题，会出现循环依赖（因为区块链的 hash pointer 与上一个相关）</p>
<p>所以区块链中，不能使用有环数据结构。</p>
<h2 id="04-"><strong>04 - 比特币协议</strong><a class="headerlink" href="#04-" title="Permanent link">#</a></h2>
<h3 id="_9"><strong>去中心化以及协议</strong><a class="headerlink" href="#_9" title="Permanent link">#</a></h3>
<p>数字货币和纸质的区别：纸质货币无法被复制，数字货币的复制却很简单（Double Spending Attack）</p>
<p>去中心化的货币，要解决的问题：</p>
<ol>
<li>谁来决定发放？也即通货膨胀问题（之后会涉及到，挖矿的问题<a href="">比特币</a>）</li>
<li>交易的有效性</li>
</ol>
<p>例子：用户 A 获得了发行比特币的权利（<strong>铸币</strong>，coinbase transaction，获得比特币的方式）。A 转给了 B 和 C；B 转给了 C 和 D；C 又转给了 E。</p>
<ol>
<li>为何要有币的来源验证？证明比特币不是凭空捏造的，也是为了防止 double spending</li>
<li>A 要给 B 转钱，那么 A 要知道 B 的地址，如何才能知道 B 的比特币地址（类似银行账户）？</li>
<li>而且 A 要证明 A 确实有这么多的钱，所以 A 的公钥也要被发布。如果有 B‘ 声明用 B’ 的公钥来代替 A 的公钥，然后假装说 A 转给了 B 的钱，那么 A 的比特币就被偷走了（因为 A 的公钥是公开的）。但是会有来源 check，所以不会被允许。</li>
</ol>
<p><img alt="协议1" src="../%E5%8D%8F%E8%AE%AE1.png" /></p>
<h3 id="block-header"><strong>Block Header</strong><a class="headerlink" href="#block-header" title="Permanent link">#</a></h3>
<p>包含区块链中宏观的信息：</p>
<ol>
<li>协议版本 version</li>
<li>包含的区块链中，前一个的指针 hash of previous block header</li>
<li>根哈希 merkle root hash</li>
<li>挖矿难度目标阈值 target，<span><span class="MathJax_Preview">H(\text{block header})\leq target</span><script type="math/tex">H(\text{block header})\leq target</script></span> </li>
<li>随机数 nonce</li>
</ol>
<h3 id="block-body"><strong>Block Body</strong><a class="headerlink" href="#block-body" title="Permanent link">#</a></h3>
<p>包含的具体信息：</p>
<ol>
<li>交易列表 transaction list</li>
</ol>
<h3 id="full-node"><strong>Full Node</strong><a class="headerlink" href="#full-node" title="Permanent link">#</a></h3>
<p>全节点</p>
<p>保证交易信息，也被称为 fully validating node</p>
<h3 id="light-node"><strong>Light Node</strong><a class="headerlink" href="#light-node" title="Permanent link">#</a></h3>
<p>轻节点</p>
<p>只保存 block  header 的信息，一般来说，无法独立验证交易。</p>
<p>系统中大部分都是轻节点，全节点较少。</p>
<h3 id="_10"><strong>分布式共识</strong><a class="headerlink" href="#_10" title="Permanent link">#</a></h3>
<p>Ditributed Consensus，简单的例子是 distributed hash table</p>
<p>比如说，在我本地是 <span><span class="MathJax_Preview">'xiao'\rightarrow 12345</span><script type="math/tex">'xiao'\rightarrow 12345</script></span>，那么需要在其他的地方，也存储这么一个 key - value 的 pair</p>
<p>分布式理论1 FLP impossibility result。在一个异步系统 asynchronous 里，即使只有一个成员是 faulty，也无法达成共识</p>
<p>分布式理论2 CAP Theorem（consistency， availability，partition tolerance）。任何一个分布式系统，这三个性质当中，最多只能满足两个。</p>
<p><a href="https://zh.wikipedia.org/wiki/Paxos%E7%AE%97%E6%B3%95">Paxos</a>协议，可以保持一致性</p>
<h3 id="consensus-in-bitcoin"><strong>比特币协议 Consensus in BitCoin</strong><a class="headerlink" href="#consensus-in-bitcoin" title="Permanent link">#</a></h3>
<p>假设大部分节点是无恶意，小部分节点是有恶意。</p>
<ol>
<li>投票？某一个节点，提出候选区块，然后开始投票。问题：有些节点不投票；效率问题；membership问题，投票权问题。比如 <a href="https://www.hyperledger.org/use/fabric">hyperledger fabric</a> 联盟链，只有大公司可以投票。女巫攻击 sybil attack：有一个超级计算机只产生 membership，超过半数，就可以控制投票结果了</li>
<li>比特币使用计算力投票，而不是账户数投票。<span><span class="MathJax_Preview">H(\text{block header})\leq target</span><script type="math/tex">H(\text{block header})\leq target</script></span> 不停的尝试不同的 nonce，如果有一台计算机搜索到了合适的 nonce，那么就称该计算机获得了记账权，才有投票的权利。</li>
<li>分叉攻击 Forking Attack：有可能有一个发生的交易，被另外的节点覆盖。那么我们有 longest valid chain 规则</li>
<li>如果有两个节点，在同时发布了同一个节点，那么等长的两个请求，无法被 longest valid chain 规则区分。那么就有 increasing consensus，就是如果有系统中同时发布区块的情况，等长的临时性分叉会维持一段时间，直至有一个分叉抢先一步先找到下一个分叉。那么另外一个就叫 orphan block，被丢弃。</li>
<li>Block reward。Coinbase Transaction 是发行新的比特币的唯一方法，其余均为转移。一开始时，每一个区块可以发布 50 BTC，但是协议中规定，21万个区块产生之后会减半，也即 12.5 BTC （2018年）</li>
</ol>
<p>比特币争夺记账权的说法叫挖矿 mining（寻找nonce的过程），争夺记账权的节点称为矿工</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../BasicConcept/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Basic Concept
              </div>
            </div>
          </a>
        
        
          <a href="../../QT/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Quantative Trading by Ernest P.Chan
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>